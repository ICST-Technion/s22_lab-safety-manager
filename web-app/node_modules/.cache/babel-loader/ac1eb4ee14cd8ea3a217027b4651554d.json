{"ast":null,"code":"import _asyncToGenerator from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/regenerator/index.js\";import{Box,CircularProgress,Typography}from\"@mui/material\";import{useEffect,useState}from\"react\";import{getStudentsDocs}from\"../../firebase/dbRef\";import{StudentsItem}from\"./StudentItem\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var StudentsPage=function StudentsPage(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),result=_useState2[0],setResult=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),refetch=_useState4[0],setRefetch=_useState4[1];var handleRefetch=function handleRefetch(){setRefetch(true);};useEffect(function(){setRefetch(false);var active=true;load();return function(){active=false;};function load(){return _load.apply(this,arguments);}function _load(){_load=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setResult(undefined);// this is optional\n_context.next=3;return getStudentsDocs();case 3:res=_context.sent;if(active){_context.next=6;break;}return _context.abrupt(\"return\");case 6:setResult(res);case 7:case\"end\":return _context.stop();}}},_callee);}));return _load.apply(this,arguments);}},[refetch]);return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\" Students \"}),!result?/*#__PURE__*/_jsx(CircularProgress,{}):result.map(function(studentItem){var _studentItem$id,_studentItem$name,_studentItem$perm_lev,_studentItem$id2;return/*#__PURE__*/_jsx(StudentsItem,{refetch:handleRefetch,student:(_studentItem$name=studentItem===null||studentItem===void 0?void 0:studentItem.name)!==null&&_studentItem$name!==void 0?_studentItem$name:\"\",perm_level:(_studentItem$perm_lev=studentItem===null||studentItem===void 0?void 0:studentItem.perm_level)!==null&&_studentItem$perm_lev!==void 0?_studentItem$perm_lev:\"\",cardId:(_studentItem$id2=studentItem===null||studentItem===void 0?void 0:studentItem.id)!==null&&_studentItem$id2!==void 0?_studentItem$id2:\"\"},(_studentItem$id=studentItem===null||studentItem===void 0?void 0:studentItem.id)!==null&&_studentItem$id!==void 0?_studentItem$id:\"\");})]});};","map":{"version":3,"names":["Box","CircularProgress","Typography","useEffect","useState","getStudentsDocs","StudentsItem","StudentsPage","result","setResult","refetch","setRefetch","handleRefetch","active","load","undefined","res","map","studentItem","name","perm_level","id"],"sources":["/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/src/components/StudentsPage/StudentsPage.tsx"],"sourcesContent":["import { Box, CircularProgress, Typography } from \"@mui/material\";\nimport { useEffect, useState } from \"react\";\nimport { getStudentsDocs } from \"../../firebase/dbRef\";\nimport { StudentsItem } from \"./StudentItem\";\n\nexport const StudentsPage = () => {\n  const [result, setResult] = useState<any>();\n  const [refetch, setRefetch] = useState<boolean>(false);\n\n  const handleRefetch = () => {\n    setRefetch(true);\n  };\n\n  useEffect(() => {\n    setRefetch(false);\n\n    let active = true;\n    load();\n    return () => {\n      active = false;\n    };\n\n    async function load() {\n      setResult(undefined); // this is optional\n      const res = await getStudentsDocs();\n      if (!active) {\n        return;\n      }\n      setResult(res);\n    }\n  }, [refetch]);\n\n  return (\n    <Box>\n      <Typography variant=\"h4\"> Students </Typography>\n      {!result ? (\n        <CircularProgress />\n      ) : (\n        result.map((studentItem: any) => (\n          <StudentsItem\n            key={studentItem?.id ?? \"\"}\n            refetch={handleRefetch}\n            student={studentItem?.name ?? \"\"}\n            perm_level={studentItem?.perm_level ?? \"\"}\n            cardId={studentItem?.id ?? \"\"}\n          />\n        ))\n      )}\n    </Box>\n  );\n};\n"],"mappings":"ybAAA,OAASA,GAAT,CAAcC,gBAAd,CAAgCC,UAAhC,KAAkD,eAAlD,CACA,OAASC,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,eAAT,KAAgC,sBAAhC,CACA,OAASC,YAAT,KAA6B,eAA7B,C,wFAEA,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CAChC,cAA4BH,QAAQ,EAApC,wCAAOI,MAAP,eAAeC,SAAf,eACA,eAA8BL,QAAQ,CAAU,KAAV,CAAtC,yCAAOM,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1BD,UAAU,CAAC,IAAD,CAAV,CACD,CAFD,CAIAR,SAAS,CAAC,UAAM,CACdQ,UAAU,CAAC,KAAD,CAAV,CAEA,GAAIE,CAAAA,MAAM,CAAG,IAAb,CACAC,IAAI,GACJ,MAAO,WAAM,CACXD,MAAM,CAAG,KAAT,CACD,CAFD,CALc,QASCC,CAAAA,IATD,sHASd,2IACEL,SAAS,CAACM,SAAD,CAAT,CAAsB;AADxB,sBAEoBV,CAAAA,eAAe,EAFnC,QAEQW,GAFR,kBAGOH,MAHP,iEAMEJ,SAAS,CAACO,GAAD,CAAT,CANF,sDATc,uCAiBf,CAjBQ,CAiBN,CAACN,OAAD,CAjBM,CAAT,CAmBA,mBACE,MAAC,GAAD,yBACE,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,wBADF,CAEG,CAACF,MAAD,cACC,KAAC,gBAAD,IADD,CAGCA,MAAM,CAACS,GAAP,CAAW,SAACC,WAAD,kGACT,KAAC,YAAD,EAEE,OAAO,CAAEN,aAFX,CAGE,OAAO,oBAAEM,WAAF,SAAEA,WAAF,iBAAEA,WAAW,CAAEC,IAAf,uDAAuB,EAHhC,CAIE,UAAU,wBAAED,WAAF,SAAEA,WAAF,iBAAEA,WAAW,CAAEE,UAAf,+DAA6B,EAJzC,CAKE,MAAM,mBAAEF,WAAF,SAAEA,WAAF,iBAAEA,WAAW,CAAEG,EAAf,qDAAqB,EAL7B,mBACOH,WADP,SACOA,WADP,iBACOA,WAAW,CAAEG,EADpB,mDAC0B,EAD1B,CADS,EAAX,CALJ,GADF,CAkBD,CA7CM"},"metadata":{},"sourceType":"module"}