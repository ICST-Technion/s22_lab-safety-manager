{"ast":null,"code":"import _asyncToGenerator from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/regenerator/index.js\";import{Box,Button,CircularProgress,Dialog,DialogActions,DialogContent,Typography,TextField,DialogTitle,DialogContentText}from\"@mui/material\";import React,{useEffect,useState}from\"react\";import{addMachineDoc,getMachinesDocs}from\"../../firebase/dbRef\";import{MachineCard}from\"./MachineCard\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var MachinePages=function MachinePages(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),result=_useState2[0],setResult=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),refetch=_useState4[0],setRefetch=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modalIsOpen=_useState6[0],setModalIsOpen=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),machineName=_useState8[0],setMachineName=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),machineDuration=_useState10[0],setMachineDuration=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),machinePrem=_useState12[0],setMachinePrem=_useState12[1];useEffect(function(){setRefetch(false);var active=true;load();return function(){active=false;};function load(){return _load.apply(this,arguments);}function _load(){_load=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setResult(undefined);// this is optional\n_context.next=3;return getMachinesDocs();case 3:res=_context.sent;if(active){_context.next=6;break;}return _context.abrupt(\"return\");case 6:setResult(res);case 7:case\"end\":return _context.stop();}}},_callee);}));return _load.apply(this,arguments);}},[refetch]);var handleChangeName=function handleChangeName(event){setMachineName(event.target.value);};var handleChangeDuration=function handleChangeDuration(event){setMachineDuration(event.target.value);};var handleChangePremission=function handleChangePremission(event){setMachinePrem(event.target.value);};var handleRefetch=function handleRefetch(){setRefetch(true);};var submitMachine=function submitMachine(){if(machineName===\"\"||machineDuration===\"\"||machinePrem===\"\"){alert(\"You didnt enter valid parametrs\");}else{addMachineDoc({name:machineName,duration:machineDuration,perm_level:machinePrem});}setModalIsOpen(false);handleRefetch();};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",justifyContent:\"space-between\",marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\" Machines \"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",onClick:function onClick(){return setModalIsOpen(true);},children:\"Add a new Machine\"})]}),!result?/*#__PURE__*/_jsx(CircularProgress,{}):/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",gap:\"8px\",maxWidth:\"700px\",flexWrap:\"wrap\"},children:result&&result.map(function(item){var _item$id,_item$id2,_item$name,_item$duration,_item$perm_level;return/*#__PURE__*/_jsx(MachineCard,{machineId:(_item$id2=item===null||item===void 0?void 0:item.id)!==null&&_item$id2!==void 0?_item$id2:\"\",machineName:(_item$name=item===null||item===void 0?void 0:item.name)!==null&&_item$name!==void 0?_item$name:\"\",duration:(_item$duration=item===null||item===void 0?void 0:item.duration)!==null&&_item$duration!==void 0?_item$duration:\"\",perm_level:(_item$perm_level=item===null||item===void 0?void 0:item.perm_level)!==null&&_item$perm_level!==void 0?_item$perm_level:\"\",refetch:handleRefetch},(_item$id=item===null||item===void 0?void 0:item.id)!==null&&_item$id!==void 0?_item$id:\"\");})})]}),/*#__PURE__*/_jsxs(Dialog,{open:modalIsOpen,onClose:function onClose(){return setModalIsOpen(false);},children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Subscribe\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(DialogContentText,{children:\"Add a new Machine\"}),/*#__PURE__*/_jsx(TextField,{autoFocus:true,margin:\"dense\",id:\"name\",label:\" Name\",type:\"text\",fullWidth:true,variant:\"standard\",onChange:handleChangeName}),/*#__PURE__*/_jsx(TextField,{autoFocus:true,margin:\"dense\",id:\"name\",label:\"Duration\",type:\"text\",fullWidth:true,variant:\"standard\",onChange:handleChangeDuration}),/*#__PURE__*/_jsx(TextField,{autoFocus:true,margin:\"dense\",id:\"name\",label:\"Permission level\",type:\"text\",fullWidth:true,variant:\"standard\",onChange:handleChangePremission})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setModalIsOpen(false);},children:\" Cancel \"}),/*#__PURE__*/_jsx(Button,{onClick:submitMachine,children:\" Submit \"})]})]})]});};","map":{"version":3,"names":["Box","Button","CircularProgress","Dialog","DialogActions","DialogContent","Typography","TextField","DialogTitle","DialogContentText","React","useEffect","useState","addMachineDoc","getMachinesDocs","MachineCard","MachinePages","result","setResult","refetch","setRefetch","modalIsOpen","setModalIsOpen","machineName","setMachineName","machineDuration","setMachineDuration","machinePrem","setMachinePrem","active","load","undefined","res","handleChangeName","event","target","value","handleChangeDuration","handleChangePremission","handleRefetch","submitMachine","alert","name","duration","perm_level","display","justifyContent","marginBottom","gap","maxWidth","flexWrap","map","item","id"],"sources":["/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/src/components/MachinesPage/MachinePage.tsx"],"sourcesContent":["import {\n  Box,\n  Button,\n  CircularProgress,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  Typography,\n  TextField,\n  DialogTitle,\n  DialogContentText,\n} from \"@mui/material\";\nimport React, { useEffect, useState } from \"react\";\nimport { addMachineDoc, getMachinesDocs } from \"../../firebase/dbRef\";\nimport { MachineCard } from \"./MachineCard\";\n\nexport const MachinePages = () => {\n  const [result, setResult] = useState<any>();\n  const [refetch, setRefetch] = useState<boolean>(false);\n\n  const [modalIsOpen, setModalIsOpen] = useState<boolean>(false);\n  const [machineName, setMachineName] = useState<string>(\"\");\n  const [machineDuration, setMachineDuration] = useState<string>(\"\");\n  const [machinePrem, setMachinePrem] = useState<string>(\"\");\n\n  useEffect(() => {\n    setRefetch(false);\n    let active = true;\n    load();\n    return () => {\n      active = false;\n    };\n\n    async function load() {\n      setResult(undefined); // this is optional\n      const res = await getMachinesDocs();\n      if (!active) {\n        return;\n      }\n      setResult(res);\n    }\n  }, [refetch]);\n\n  const handleChangeName = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setMachineName(event.target.value);\n  };\n\n  const handleChangeDuration = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setMachineDuration(event.target.value);\n  };\n\n  const handleChangePremission = (\n    event: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    setMachinePrem(event.target.value);\n  };\n\n  const handleRefetch = () => {\n    setRefetch(true);\n  };\n\n  const submitMachine = () => {\n    if (machineName === \"\" || machineDuration === \"\" || machinePrem === \"\") {\n      alert(\"You didnt enter valid parametrs\");\n    } else {\n      addMachineDoc({\n        name: machineName,\n        duration: machineDuration,\n        perm_level: machinePrem,\n      });\n    }\n    setModalIsOpen(false);\n    handleRefetch();\n  };\n\n  return (\n    <>\n      <Box>\n        <Box\n          sx={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            marginBottom: \"10px\",\n          }}\n        >\n          <Typography variant=\"h4\"> Machines </Typography>\n          <Button\n            variant=\"contained\"\n            color=\"secondary\"\n            onClick={() => setModalIsOpen(true)}\n          >\n            Add a new Machine\n          </Button>\n        </Box>\n        {!result ? (\n          <CircularProgress />\n        ) : (\n          <Box\n            sx={{\n              display: \"flex\",\n              gap: \"8px\",\n              maxWidth: \"700px\",\n              flexWrap: \"wrap\",\n            }}\n          >\n            {result &&\n              result.map((item: any) => (\n                <MachineCard\n                  key={item?.id ?? \"\"}\n                  machineId={item?.id ?? \"\"}\n                  machineName={item?.name ?? \"\"}\n                  duration={item?.duration ?? \"\"}\n                  perm_level={item?.perm_level ?? \"\"}\n                  refetch={handleRefetch}\n                />\n              ))}\n          </Box>\n        )}\n      </Box>\n\n      <Dialog open={modalIsOpen} onClose={() => setModalIsOpen(false)}>\n        <DialogTitle>Subscribe</DialogTitle>\n        <DialogContent>\n          <DialogContentText>Add a new Machine</DialogContentText>\n          <TextField\n            autoFocus\n            margin=\"dense\"\n            id=\"name\"\n            label=\" Name\"\n            type=\"text\"\n            fullWidth\n            variant=\"standard\"\n            onChange={handleChangeName}\n          />\n          <TextField\n            autoFocus\n            margin=\"dense\"\n            id=\"name\"\n            label=\"Duration\"\n            type=\"text\"\n            fullWidth\n            variant=\"standard\"\n            onChange={handleChangeDuration}\n          />\n          <TextField\n            autoFocus\n            margin=\"dense\"\n            id=\"name\"\n            label=\"Permission level\"\n            type=\"text\"\n            fullWidth\n            variant=\"standard\"\n            onChange={handleChangePremission}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setModalIsOpen(false)}> Cancel </Button>\n          <Button onClick={submitMachine}> Submit </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}