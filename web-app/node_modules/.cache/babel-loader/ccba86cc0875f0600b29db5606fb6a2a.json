{"ast":null,"code":"import _asyncToGenerator from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/regenerator/index.js\";import{Box,CircularProgress,Typography}from\"@mui/material\";import{useEffect,useState}from\"react\";import{getRegistrationDocs}from\"../../firebase/dbRef\";import{RegistrationItem}from\"./RegistrationItem\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var RegistrationPage=function RegistrationPage(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),result=_useState2[0],setResult=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),refetch=_useState4[0],setRefetch=_useState4[1];var handleRefetch=function handleRefetch(){setRefetch(true);};useEffect(function(){setRefetch(false);var active=true;load();return function(){active=false;};function load(){return _load.apply(this,arguments);}function _load(){_load=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setResult(undefined);// this is optional\n_context.next=3;return getRegistrationDocs();case 3:res=_context.sent;if(active){_context.next=6;break;}return _context.abrupt(\"return\");case 6:setResult(res);case 7:case\"end\":return _context.stop();}}},_callee);}));return _load.apply(this,arguments);}},[refetch]);return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\" Registration \"}),!result?/*#__PURE__*/_jsx(CircularProgress,{}):result.map(function(item){var _item$id,_item$id2,_item$time,_item$card_id;return/*#__PURE__*/_jsx(RegistrationItem,{refetch:handleRefetch,regDocId:(_item$id2=item===null||item===void 0?void 0:item.id)!==null&&_item$id2!==void 0?_item$id2:\"\",date:(_item$time=item===null||item===void 0?void 0:item.time)!==null&&_item$time!==void 0?_item$time:\"\",cardId:(_item$card_id=item.card_id)!==null&&_item$card_id!==void 0?_item$card_id:\"\"},(_item$id=item===null||item===void 0?void 0:item.id)!==null&&_item$id!==void 0?_item$id:\"\");})]});};","map":{"version":3,"names":["Box","CircularProgress","Typography","useEffect","useState","getRegistrationDocs","RegistrationItem","RegistrationPage","result","setResult","refetch","setRefetch","handleRefetch","active","load","undefined","res","map","item","id","time","card_id"],"sources":["/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/src/components/RegistrationPage/RegistrationPage.tsx"],"sourcesContent":["import { Box, CircularProgress, Typography } from \"@mui/material\";\nimport { useEffect, useState } from \"react\";\nimport { getRegistrationDocs } from \"../../firebase/dbRef\";\nimport { RegistrationItem } from \"./RegistrationItem\";\n\nexport const RegistrationPage = () => {\n  const [result, setResult] = useState<any>();\n  const [refetch, setRefetch] = useState<boolean>(false);\n\n  const handleRefetch = () => {\n    setRefetch(true);\n  };\n\n  useEffect(() => {\n    setRefetch(false);\n    let active = true;\n    load();\n    return () => {\n      active = false;\n    };\n\n    async function load() {\n      setResult(undefined); // this is optional\n      const res = await getRegistrationDocs();\n      if (!active) {\n        return;\n      }\n      setResult(res);\n    }\n  }, [refetch]);\n\n  return (\n    <Box>\n      <Typography variant=\"h4\"> Registration </Typography>\n      {!result ? (\n        <CircularProgress />\n      ) : (\n        result.map((item: any) => (\n          <RegistrationItem\n            refetch={handleRefetch}\n            key={item?.id ?? \"\"}\n            regDocId={item?.id ?? \"\"}\n            date={item?.time ?? \"\"}\n            cardId={item.card_id ?? \"\"}\n          />\n        ))\n      )}\n    </Box>\n  );\n};\n"],"mappings":"ybAAA,OAASA,GAAT,CAAcC,gBAAd,CAAgCC,UAAhC,KAAkD,eAAlD,CACA,OAASC,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,mBAAT,KAAoC,sBAApC,CACA,OAASC,gBAAT,KAAiC,oBAAjC,C,wFAEA,MAAO,IAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CACpC,cAA4BH,QAAQ,EAApC,wCAAOI,MAAP,eAAeC,SAAf,eACA,eAA8BL,QAAQ,CAAU,KAAV,CAAtC,yCAAOM,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1BD,UAAU,CAAC,IAAD,CAAV,CACD,CAFD,CAIAR,SAAS,CAAC,UAAM,CACdQ,UAAU,CAAC,KAAD,CAAV,CACA,GAAIE,CAAAA,MAAM,CAAG,IAAb,CACAC,IAAI,GACJ,MAAO,WAAM,CACXD,MAAM,CAAG,KAAT,CACD,CAFD,CAJc,QAQCC,CAAAA,IARD,sHAQd,2IACEL,SAAS,CAACM,SAAD,CAAT,CAAsB;AADxB,sBAEoBV,CAAAA,mBAAmB,EAFvC,QAEQW,GAFR,kBAGOH,MAHP,iEAMEJ,SAAS,CAACO,GAAD,CAAT,CANF,sDARc,uCAgBf,CAhBQ,CAgBN,CAACN,OAAD,CAhBM,CAAT,CAkBA,mBACE,MAAC,GAAD,yBACE,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,4BADF,CAEG,CAACF,MAAD,cACC,KAAC,gBAAD,IADD,CAGCA,MAAM,CAACS,GAAP,CAAW,SAACC,IAAD,qEACT,KAAC,gBAAD,EACE,OAAO,CAAEN,aADX,CAGE,QAAQ,YAAEM,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEC,EAAR,uCAAc,EAHxB,CAIE,IAAI,aAAED,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEE,IAAR,yCAAgB,EAJtB,CAKE,MAAM,gBAAEF,IAAI,CAACG,OAAP,+CAAkB,EAL1B,YAEOH,IAFP,SAEOA,IAFP,iBAEOA,IAAI,CAAEC,EAFb,qCAEmB,EAFnB,CADS,EAAX,CALJ,GADF,CAkBD,CA5CM"},"metadata":{},"sourceType":"module"}