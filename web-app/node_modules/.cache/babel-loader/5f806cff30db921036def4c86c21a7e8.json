{"ast":null,"code":"import _asyncToGenerator from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/node_modules/@babel/runtime/regenerator/index.js\";import{Box,CircularProgress,Typography}from\"@mui/material\";import{useEffect,useState}from\"react\";import{getHistoryDocs}from\"../../firebase/dbRef\";import{HistoryItem}from\"./HistoryItem\";import Stack from'@mui/material/Stack';import{styled}from'@mui/material/styles';import Paper from'@mui/material/Paper';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Item=styled(Paper)(function(_ref){var theme=_ref.theme;return _objectSpread(_objectSpread({backgroundColor:'#64b5f6'},theme.typography.body2),{},{padding:theme.spacing(1),textAlign:'center',color:theme.palette.text.primary});});export var HistoryPage=function HistoryPage(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),result=_useState2[0],setResult=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),refetch=_useState4[0],setRefetch=_useState4[1];var handleRefetch=function handleRefetch(){setRefetch(true);};useEffect(function(){setRefetch(false);var active=true;load();return function(){active=false;};function load(){return _load.apply(this,arguments);}function _load(){_load=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setResult(undefined);// this is optional\n_context.next=3;return getHistoryDocs();case 3:res=_context.sent;if(active){_context.next=6;break;}return _context.abrupt(\"return\");case 6:setResult(res);case 7:case\"end\":return _context.stop();}}},_callee);}));return _load.apply(this,arguments);}},[refetch]);return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\" History \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsxs(Stack,{direction:\"row\",justifyContent:\"center\",spacing:20,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"CardID\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"MachineID\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"Date\"})]})}),!result?/*#__PURE__*/_jsx(CircularProgress,{}):result.map(function(item){var _item$id,_item$time,_item$card_id,_item$machine_id;return/*#__PURE__*/_jsx(HistoryItem,{refetch:handleRefetch,date:(_item$time=item===null||item===void 0?void 0:item.time)!==null&&_item$time!==void 0?_item$time:\"\",cardId:(_item$card_id=item===null||item===void 0?void 0:item.card_id)!==null&&_item$card_id!==void 0?_item$card_id:\"\",machineId:(_item$machine_id=item===null||item===void 0?void 0:item.machine_id)!==null&&_item$machine_id!==void 0?_item$machine_id:\"\"},(_item$id=item===null||item===void 0?void 0:item.id)!==null&&_item$id!==void 0?_item$id:\"\");})]});};","map":{"version":3,"names":["Box","CircularProgress","Typography","useEffect","useState","getHistoryDocs","HistoryItem","Stack","styled","Paper","Item","theme","backgroundColor","typography","body2","padding","spacing","textAlign","color","palette","text","primary","HistoryPage","result","setResult","refetch","setRefetch","handleRefetch","active","load","undefined","res","map","item","time","card_id","machine_id","id"],"sources":["/Users/toharayash/Desktop/technion/semester8/iot/iot-web-app/src/components/HistoryPage/HistoryPage.tsx"],"sourcesContent":["import { Box, CircularProgress, Typography } from \"@mui/material\";\nimport { useEffect, useState } from \"react\";\nimport { getHistoryDocs } from \"../../firebase/dbRef\";\nimport { HistoryItem } from \"./HistoryItem\";\nimport Stack from '@mui/material/Stack';\nimport { styled } from '@mui/material/styles';\nimport Paper from '@mui/material/Paper';\n\n\nconst Item = styled(Paper)(({ theme }) => ({\n    backgroundColor: '#64b5f6',\n    ...theme.typography.body2,\n    padding: theme.spacing(1),\n    textAlign: 'center',\n    color: theme.palette.text.primary,\n  }));\n\nexport const HistoryPage = () => {\n  const [result, setResult] = useState<any>();\n  const [refetch, setRefetch] = useState<boolean>(false);\n\n  const handleRefetch = () => {\n    setRefetch(true);\n  };\n\n  useEffect(() => {\n    setRefetch(false);\n\n    let active = true;\n    load();\n    return () => {\n      active = false;\n    };\n\n    async function load() {\n      setResult(undefined); // this is optional\n      const res = await getHistoryDocs();\n      if (!active) {\n        return;\n      }\n      setResult(res);\n    }\n  }, [refetch]);\n\n\n  return (\n    <Box>\n      <Typography variant=\"h4\"> History </Typography>\n      <br></br>\n      <Box>\n        <Stack direction=\"row\"  justifyContent=\"center\" spacing={20} > \n            <Typography variant=\"h5\">CardID</Typography>\n            <Typography variant=\"h5\">MachineID</Typography>\n            <Typography variant=\"h5\">Date</Typography>\n        </Stack>\n      </Box>\n\n      {!result ? (\n        <CircularProgress />\n      ) : (\n        result.map((item: any) => (\n          <HistoryItem\n            key={item?.id ?? \"\"}\n            refetch={handleRefetch}\n            date={item?.time ?? \"\"}\n            cardId={item?.card_id ?? \"\"}\n            machineId={item?.machine_id ?? \"\"}\n          />\n        ))\n      )}\n    </Box>\n  );\n};\n"],"mappings":"0kBAAA,OAASA,GAAT,CAAcC,gBAAd,CAAgCC,UAAhC,KAAkD,eAAlD,CACA,OAASC,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,cAAT,KAA+B,sBAA/B,CACA,OAASC,WAAT,KAA4B,eAA5B,CACA,MAAOC,CAAAA,KAAP,KAAkB,qBAAlB,CACA,OAASC,MAAT,KAAuB,sBAAvB,CACA,MAAOC,CAAAA,KAAP,KAAkB,qBAAlB,C,wFAGA,GAAMC,CAAAA,IAAI,CAAGF,MAAM,CAACC,KAAD,CAAN,CAAc,kBAAGE,CAAAA,KAAH,MAAGA,KAAH,qCACvBC,eAAe,CAAE,SADM,EAEpBD,KAAK,CAACE,UAAN,CAAiBC,KAFG,MAGvBC,OAAO,CAAEJ,KAAK,CAACK,OAAN,CAAc,CAAd,CAHc,CAIvBC,SAAS,CAAE,QAJY,CAKvBC,KAAK,CAAEP,KAAK,CAACQ,OAAN,CAAcC,IAAd,CAAmBC,OALH,IAAd,CAAb,CAQA,MAAO,IAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CAC/B,cAA4BlB,QAAQ,EAApC,wCAAOmB,MAAP,eAAeC,SAAf,eACA,eAA8BpB,QAAQ,CAAU,KAAV,CAAtC,yCAAOqB,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1BD,UAAU,CAAC,IAAD,CAAV,CACD,CAFD,CAIAvB,SAAS,CAAC,UAAM,CACduB,UAAU,CAAC,KAAD,CAAV,CAEA,GAAIE,CAAAA,MAAM,CAAG,IAAb,CACAC,IAAI,GACJ,MAAO,WAAM,CACXD,MAAM,CAAG,KAAT,CACD,CAFD,CALc,QASCC,CAAAA,IATD,sHASd,2IACEL,SAAS,CAACM,SAAD,CAAT,CAAsB;AADxB,sBAEoBzB,CAAAA,cAAc,EAFlC,QAEQ0B,GAFR,kBAGOH,MAHP,iEAMEJ,SAAS,CAACO,GAAD,CAAT,CANF,sDATc,uCAiBf,CAjBQ,CAiBN,CAACN,OAAD,CAjBM,CAAT,CAoBA,mBACE,MAAC,GAAD,yBACE,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,uBADF,cAEE,aAFF,cAGE,KAAC,GAAD,wBACE,MAAC,KAAD,EAAO,SAAS,CAAC,KAAjB,CAAwB,cAAc,CAAC,QAAvC,CAAgD,OAAO,CAAE,EAAzD,wBACI,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,oBADJ,cAEI,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,uBAFJ,cAGI,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,kBAHJ,GADF,EAHF,CAWG,CAACF,MAAD,cACC,KAAC,gBAAD,IADD,CAGCA,MAAM,CAACS,GAAP,CAAW,SAACC,IAAD,4EACT,KAAC,WAAD,EAEE,OAAO,CAAEN,aAFX,CAGE,IAAI,aAAEM,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEC,IAAR,yCAAgB,EAHtB,CAIE,MAAM,gBAAED,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEE,OAAR,+CAAmB,EAJ3B,CAKE,SAAS,mBAAEF,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEG,UAAR,qDAAsB,EALjC,YACOH,IADP,SACOA,IADP,iBACOA,IAAI,CAAEI,EADb,qCACmB,EADnB,CADS,EAAX,CAdJ,GADF,CA2BD,CAvDM"},"metadata":{},"sourceType":"module"}